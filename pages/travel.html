<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Seyahat Planlayƒ±cƒ±</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <style>
    :root {
      --bg:#0b1221;
      --panel:#101a30;
      --accent:#22d3ee;
      --accent2:#a855f7;
      --text:#e5e7eb;
      --muted:#94a3b8;
    }

    *{box-sizing:border-box;}

    html,body{
      margin:0;
      padding:0;
    }

    body{
      font-family:"Inter","Segoe UI",sans-serif;
      color:var(--text);
      min-height:100vh;
      position:relative;
      overflow-x:hidden;
      background:
        radial-gradient(circle at 20% 20%,rgba(34,211,238,0.14),transparent 30%),
        radial-gradient(circle at 80% 0%,rgba(168,85,247,0.18),transparent 35%),
        linear-gradient(135deg,#020617,#020617 40%,#0b1221 60%,#0f172a 100%);
      background-size:200% 200%;
      animation:gradientShift 26s ease-in-out infinite;
    }

    /* Arka plan grid + noise + glow orblar */
    .bg-grid{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:-2;
      background-image:
        linear-gradient(rgba(148,163,184,0.08) 1px, transparent 1px),
        linear-gradient(90deg, rgba(148,163,184,0.08) 1px, transparent 1px);
      background-size:40px 40px;
      opacity:0.4;
      mix-blend-mode:soft-light;
      transform:translate3d(0,0,0);
    }

    .bg-orb{
      position:fixed;
      width:420px;
      height:420px;
      border-radius:999px;
      filter:blur(60px);
      opacity:0.45;
      pointer-events:none;
      z-index:-3;
      background:radial-gradient(circle, rgba(34,211,238,0.65), transparent 65%);
      animation:orbDrift 32s ease-in-out infinite alternate;
    }
    .bg-orb.orb-2{
      background:radial-gradient(circle, rgba(168,85,247,0.7), transparent 65%);
      animation-delay:-10s;
    }

    body::before{
      content:"";
      position:fixed;
      inset:-40px;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      mix-blend-mode:soft-light;
      opacity:0.55;
      pointer-events:none;
      z-index:-1;
    }

    @keyframes gradientShift{
      0%,100%{background-position:0% 50%;}
      50%{background-position:100% 50%;}
    }

    @keyframes orbDrift{
      0%{transform:translate3d(-10%,10%,0);}
      50%{transform:translate3d(35%,-5%,0);}
      100%{transform:translate3d(5%,25%,0);}
    }

    /* Hover ile parlayan imle√ß efekti */
    .cursor-glow{
      position:fixed;
      width:260px;
      height:260px;
      border-radius:999px;
      pointer-events:none;
      z-index:0;
      background:radial-gradient(circle at center, rgba(34,211,238,0.22), transparent 70%);
      mix-blend-mode:screen;
      opacity:0;
      transition:opacity .25s ease-out;
      transform:translate3d(-50%,-50%,0);
    }

    body:hover .cursor-glow{
      opacity:1;
    }

    header{
      max-width:1180px;
      margin:0 auto;
      padding:22px 18px 10px;
      display:flex;
      align-items:center;
      gap:14px;
      flex-wrap:wrap;
      position:relative;
      z-index:1;
    }

    header::before{
      content:"";
      position:absolute;
      inset:8px 12px;
      border-radius:18px;
      background:radial-gradient(circle at top left,rgba(34,211,238,0.22),transparent 60%);
      opacity:0.3;
      pointer-events:none;
      mix-blend-mode:screen;
    }

    .btn-home{
      padding:9px 13px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.5);
      background:
        radial-gradient(circle at 0 0, rgba(34,211,238,0.2), transparent 55%),
        rgba(15,23,42,0.88);
      color:#7dd3fc;
      text-decoration:none;
      font-size:13px;
      letter-spacing:0.04em;
      text-transform:uppercase;
      display:inline-flex;
      align-items:center;
      gap:6px;
      position:relative;
      overflow:hidden;
      backdrop-filter:blur(12px);
      box-shadow:0 16px 35px rgba(15,23,42,0.75);
      transition:transform .18s ease-out, box-shadow .18s ease-out, border-color .18s, background .18s;
    }

    .btn-home::after{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(120deg,rgba(255,255,255,0.24),transparent 40%,transparent 60%,rgba(255,255,255,0.18));
      transform:translateX(-120%);
      transition:transform .4s ease-out;
      opacity:0.75;
    }

    .btn-home:hover{
      transform:translateY(-1px) translateZ(0);
      border-color:rgba(56,189,248,0.9);
      box-shadow:0 20px 45px rgba(8,47,73,0.85);
      background:
        radial-gradient(circle at 0 0, rgba(34,211,238,0.32), transparent 55%),
        rgba(15,23,42,0.94);
    }

    .btn-home:hover::after{
      transform:translateX(120%);
    }

    h1{
      margin:0;
      font-size:32px;
      letter-spacing:0.5px;
      background:linear-gradient(120deg,#e5e7eb,#bae6fd,#a855f7);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow:0 0 18px rgba(15,23,42,0.8);
    }

    p.lead{
      margin:6px 0 0;
      color:var(--muted);
      font-size:14px;
    }

    .panel{
      max-width:1180px;
      margin:0 auto 32px;
      padding:18px;
      background:linear-gradient(145deg,rgba(15,23,42,0.96),rgba(15,23,42,0.92));
      border-radius:20px;
      position:relative;
      overflow:hidden;
      border:1px solid rgba(148,163,184,0.4);
      box-shadow:
        0 28px 80px rgba(0,0,0,0.85),
        0 0 0 1px rgba(15,23,42,0.9);
      backdrop-filter:blur(18px);
    }

    .panel::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        radial-gradient(circle at 0% 0%,rgba(34,211,238,0.12),transparent 55%),
        radial-gradient(circle at 100% 0%,rgba(168,85,247,0.12),transparent 55%);
      opacity:0.7;
      mix-blend-mode:screen;
      pointer-events:none;
    }

    .panel::after{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius:inherit;
      border:1px solid rgba(148,163,184,0.35);
      mask:linear-gradient(#000,#000) content-box,linear-gradient(#000,#000);
      -webkit-mask:linear-gradient(#000,#000) content-box,linear-gradient(#000,#000);
      -webkit-mask-composite:xor;
      mask-composite:exclude;
      padding:1px;
      opacity:0.8;
      pointer-events:none;
    }

    .bar{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-bottom:12px;
      position:relative;
      z-index:1;
    }

    input, select{
      padding:11px 13px;
      border-radius:13px;
      border:1px solid rgba(148,163,184,0.35);
      background:radial-gradient(circle at 0 0,rgba(15,23,42,0.9),rgba(15,23,42,0.96));
      color:#e5e7eb;
      min-width:180px;
      font-size:14px;
      outline:none;
      transition:border-color .18s ease, box-shadow .18s ease, background .18s ease, transform .12s ease;
      box-shadow:0 0 0 1px rgba(15,23,42,0.95);
    }

    input::placeholder{
      color:rgba(148,163,184,0.7);
    }

    input:focus{
      border-color:rgba(56,189,248,0.95);
      box-shadow:0 0 0 1px rgba(56,189,248,0.9), 0 0 32px rgba(8,47,73,0.9);
      background:radial-gradient(circle at 0 0,rgba(15,23,42,0.96),rgba(15,23,42,1));
      transform:translateY(-1px);
    }

    .btn{
      border:none;
      padding:11px 16px;
      border-radius:999px;
      background:
        linear-gradient(110deg,rgba(34,211,238,0.95),rgba(59,130,246,1),rgba(168,85,247,0.95));
      color:#fff;
      cursor:pointer;
      transition:transform .16s ease-out, box-shadow .18s ease-out, filter .18s ease-out;
      box-shadow:
        0 15px 35px rgba(8,47,73,0.9),
        0 0 24px rgba(59,130,246,0.85);
      font-weight:500;
      font-size:14px;
      position:relative;
      overflow:hidden;
      text-shadow:0 1px 4px rgba(15,23,42,0.8);
    }

    .btn::after{
      content:"";
      position:absolute;
      inset:-20px;
      background:linear-gradient(120deg,rgba(255,255,255,0.7),transparent 40%,transparent 60%,rgba(255,255,255,0.6));
      transform:translateX(-120%);
      opacity:0.85;
      pointer-events:none;
      transition:transform .45s ease-out;
    }

    .btn:hover{
      transform:translateY(-1px) scale(1.02);
      box-shadow:
        0 20px 45px rgba(15,23,42,0.95),
        0 0 32px rgba(59,130,246,0.95);
      filter:saturate(1.15);
    }

    .btn:hover::after{
      transform:translateX(120%);
    }

    .badge{
      display:inline-block;
      padding:4px 9px;
      border-radius:999px;
      background:rgba(15,23,42,0.8);
      color:#7dd3fc;
      font-size:11px;
      border:1px solid rgba(56,189,248,0.85);
      letter-spacing:0.08em;
      text-transform:uppercase;
    }

    .muted{color:var(--muted);}

    #status{
      font-size:11px;
    }

    .chips{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-bottom:12px;
      position:relative;
      z-index:1;
    }

    .chip{
      padding:7px 11px;
      border-radius:999px;
      background:rgba(15,23,42,0.9);
      color:#7dd3fc;
      border:1px solid rgba(56,189,248,0.55);
      cursor:pointer;
      transition:all .18s ease-out;
      font-size:12px;
      position:relative;
      overflow:hidden;
    }

    .chip::after{
      content:"";
      position:absolute;
      inset:0;
      background:radial-gradient(circle at 0 0,rgba(56,189,248,0.3),transparent 60%);
      opacity:0;
      transition:opacity .24s ease-out;
      pointer-events:none;
    }

    .chip:hover{
      background:rgba(15,23,42,0.98);
      transform:translateY(-1px);
      box-shadow:0 8px 22px rgba(8,47,73,0.75);
    }

    .chip:hover::after{
      opacity:1;
    }

    .chip-active{
      background:linear-gradient(120deg,rgba(34,211,238,0.3),rgba(59,130,246,0.35));
      color:#e0f2fe;
      box-shadow:0 10px 26px rgba(8,47,73,0.9);
      border-color:rgba(56,189,248,0.95);
    }

    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:12px;
      position:relative;
      z-index:1;
    }

    .card{
      background:radial-gradient(circle at top left,rgba(34,211,238,0.09),transparent 55%), #0b1221;
      border:1px solid rgba(148,163,184,0.35);
      border-radius:16px;
      padding:14px;
      position:relative;
      overflow:hidden;
      box-shadow:0 18px 45px rgba(15,23,42,0.95);
      transform-style:preserve-3d;
      transition:
        transform .22s ease-out,
        box-shadow .22s ease-out,
        border-color .18s ease,
        background .22s ease-out;
    }

    .card::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        radial-gradient(circle at 0 0,rgba(34,211,238,0.18),transparent 60%),
        radial-gradient(circle at 100% 100%,rgba(168,85,247,0.16),transparent 60%);
      opacity:0;
      transition:opacity .3s ease-out;
      mix-blend-mode:screen;
      pointer-events:none;
    }

    .card::after{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius:inherit;
      border:1px solid rgba(148,163,184,0.4);
      opacity:0.55;
      mask:linear-gradient(#000,#000) content-box,linear-gradient(#000,#000);
      -webkit-mask:linear-gradient(#000,#000) content-box,linear-gradient(#000,#000);
      -webkit-mask-composite:xor;
      mask-composite:exclude;
      padding:1px;
      pointer-events:none;
    }

    .card:hover{
      transform:translateY(-4px) translateZ(0) rotateX(0.6deg);
      box-shadow:
        0 24px 70px rgba(15,23,42,0.98),
        0 0 40px rgba(34,211,238,0.5);
      border-color:rgba(56,189,248,0.9);
      background:radial-gradient(circle at top left,rgba(34,211,238,0.16),transparent 60%), #020617;
    }

    .card:hover::before{
      opacity:1;
    }

    .flex{
      display:flex;
      justify-content:space-between;
      gap:8px;
      flex-wrap:wrap;
    }

    .stat{
      background:rgba(15,23,42,0.95);
      border:1px solid rgba(148,163,184,0.45);
      border-radius:13px;
      padding:9px;
      min-width:120px;
      text-align:center;
      box-shadow:0 12px 26px rgba(15,23,42,0.95);
      font-size:13px;
    }

    .stat strong{
      font-size:13px;
    }

    .floaty{
      animation:float 5s ease-in-out infinite;
    }

    @keyframes float{
      0%{transform:translateY(0);}
      50%{transform:translateY(-6px);}
      100%{transform:translateY(0);}
    }

    #map{
      height:320px;
      border-radius:14px;
      border:1px solid rgba(148,163,184,0.45);
      margin-top:10px;
      box-shadow:0 14px 40px rgba(15,23,42,0.95);
    }

    #routeInfo{
      margin-top:8px;
      font-size:13px;
    }

    #planCard{
      margin-top:12px;
    }

    #planList{
      margin-top:8px;
      padding-left:18px;
      font-size:13px;
    }

    /* Scroll reveal efektleri */
    .reveal-init{
      opacity:0;
      transform:translateY(12px) scale(0.985);
      filter:blur(4px);
      transition:
        opacity .5s ease-out,
        transform .5s ease-out,
        filter .5s ease-out;
    }

    .reveal-visible{
      opacity:1;
      transform:translateY(0) scale(1);
      filter:blur(0);
    }

    /* K√º√ß√ºk ekran uyumu */
    @media (max-width:640px){
      header{
        padding-top:18px;
      }
      h1{
        font-size:26px;
      }
      .panel{
        padding:14px;
      }
      .grid{
        grid-template-columns:1fr;
      }
      .bar{
        flex-direction:column;
        align-items:stretch;
      }
      .btn-home{
        order:2;
      }
    }
  </style>
</head>
<body>
  <!-- Arka plan efektleri -->
  <div class="bg-grid"></div>
  <div class="bg-orb orb-1"></div>
  <div class="bg-orb orb-2"></div>
  <div class="cursor-glow"></div>

  <header class="reveal-init">
    <a class="btn-home" href="../index.html">
      <span>‚Üê Ana sayfa</span>
    </a>
    <div>
      <h1>Seyahat Planlayƒ±cƒ±</h1>
      <p class="lead">≈ûehir, rota, harita; pop√ºler yerler i√ßin g√ºnl√ºk √∂neri.</p>
    </div>
  </header>

  <div class="panel reveal-init">
    <div class="bar">
      <input id="city" placeholder="≈ûehir veya √ºlke (√∂rn: Tokyo)">
      <input id="dest" placeholder="Varƒ±≈ü (opsiyonel)">
      <button class="btn" id="search">Ara</button>
      <span class="badge" id="status">Hazƒ±r</span>
    </div>
    <div class="chips" id="preset"></div>
    <div class="grid" id="cards">
      <div class="card reveal-init">≈ûehir se√ßin.</div>
    </div>
    <div class="card reveal-init" style="margin-top:12px;">
      <div class="badge">Harita & Mesafe</div>
      <div id="map"></div>
      <div class="muted" id="routeInfo"></div>
    </div>
    <div class="card reveal-init" id="planCard" style="margin-top:12px;">
      <div class="badge">G√ºnl√ºk Plan</div>
      <ol id="planList" class="muted"></ol>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
  // Pointer glow & hafif parallax
  (function(){
    const glow = document.querySelector('.cursor-glow');
    const panel = document.querySelector('.panel');

    window.addEventListener('pointermove', (e) => {
      glow.style.transform = 'translate3d(' + (e.clientX) + 'px,' + (e.clientY) + 'px,0)';
    });

    if(panel){
      panel.addEventListener('pointermove', (e) => {
        const rect = panel.getBoundingClientRect();
        const centerX = rect.left + rect.width/2;
        const centerY = rect.top + rect.height/2;
        const dx = (e.clientX - centerX) / rect.width;
        const dy = (e.clientY - centerY) / rect.height;
        panel.style.transform = 'perspective(900px) rotateX(' + (dy * -4) + 'deg) rotateY(' + (dx * 6) + 'deg)';
      });
      panel.addEventListener('pointerleave', () => {
        panel.style.transform = 'perspective(900px) rotateX(0deg) rotateY(0deg)';
      });
    }

    // Scroll reveal
    const revealEls = document.querySelectorAll('.reveal-init');
    const io = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          entry.target.classList.add('reveal-visible');
          io.unobserve(entry.target);
        }
      });
    }, {threshold:0.15});

    revealEls.forEach(el => io.observe(el));
  })();

  // Asƒ±l uygulama
  (function(){
    const presets=[
      "Istanbul","Ankara","Izmir","London","Paris","Berlin","Madrid","Rome",
      "New York","Los Angeles","Chicago","Toronto","Mexico City","Sao Paulo","Buenos Aires","Rio de Janeiro",
      "Cairo","Lagos","Johannesburg","Nairobi",
      "Moscow","Delhi","Mumbai","Bangalore","Beijing","Shanghai","Shenzhen","Guangzhou","Seoul","Tokyo","Osaka","Bangkok","Jakarta","Singapore","Hong Kong"
    ];
    const cards=document.getElementById("cards");
    const status=document.getElementById("status");
    const cityInput=document.getElementById("city");
    const destInput=document.getElementById("dest");
    const presetWrap=document.getElementById("preset");
    const routeInfo=document.getElementById("routeInfo");
    const planList=document.getElementById("planList");

    const weatherIcons={0:"‚òÄÔ∏è",1:"üå§Ô∏è",2:"‚õÖ",3:"‚òÅÔ∏è",45:"üå´Ô∏è",48:"üå´Ô∏è",51:"üå¶Ô∏è",61:"üåßÔ∏è",71:"üå®Ô∏è",80:"üåßÔ∏è",95:"‚õàÔ∏è"};
    const poiDb={
      Istanbul:["Galata Kulesi","Topkapƒ± Sarayƒ±","Ayasofya","Sultanahmet","Karak√∂y","Kadƒ±k√∂y √áar≈üƒ±sƒ±"],
      Paris:["Eiffel","Louvre","Notre Dame","Montmartre","Luxembourg Park"],
      Tokyo:["Senso-ji","Shibuya Crossing","Meiji Shrine","Akihabara","Ueno Park"],
      Rome:["Colosseum","Trevi","Pantheon","Vatican"],
      London:["Big Ben","London Eye","British Museum","Borough Market"],
      "New York":["Central Park","Times Square","MoMA","Brooklyn Bridge"]
    };

    function fmt(n){return typeof n==="number"?n.toFixed(1):n;}
    function haversine(a,b){
      const R=6371,toRad=x=>x*Math.PI/180;
      const dLat=toRad(b.lat-a.lat),dLon=toRad(b.lon-a.lon);
      const lat1=toRad(a.lat),lat2=toRad(b.lat);
      const h=Math.sin(dLat/2)**2+Math.cos(lat1)*Math.cos(lat2)*Math.sin(dLon/2)**2;
      return 2*R*Math.asin(Math.sqrt(h));
    }

    // Preset chipleri √ºret
    presetWrap.innerHTML=presets.map(p=>`<span class="chip" data-city="${p}">${p}</span>`).join("");

    presetWrap.addEventListener("click",e=>{
      const chip=e.target.closest(".chip");
      if(!chip) return;

      // Aktif chip vurgusu
      presetWrap.querySelectorAll(".chip").forEach(c=>c.classList.remove("chip-active"));
      chip.classList.add("chip-active");

      const c=chip.dataset.city;
      if(!c) return;

      if(document.activeElement===destInput){
        destInput.value=c;
      } else if(!cityInput.value){
        cityInput.value=c;
        loadCity(c);
        return;
      } else if(!destInput.value){
        destInput.value=c;
      } else {
        cityInput.value=c;
        destInput.value="";
        loadCity(c);
        return;
      }
      if(cityInput.value) loadCity(cityInput.value);
    });

    document.getElementById("search").addEventListener("click",()=>loadCity(cityInput.value.trim()));
    cityInput.addEventListener("keydown",e=>{if(e.key==="Enter") loadCity(cityInput.value.trim());});
    destInput.addEventListener("keydown",e=>{if(e.key==="Enter") loadCity(cityInput.value.trim());});

    // Leaflet harita
    const map=L.map("map").setView([39,35],5);
    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"¬© OpenStreetMap"}).addTo(map);
    let markers=[];
    let poly=null;

    function setMarkers(points){
      markers.forEach(m=>map.removeLayer(m));
      markers=points.map(p=>L.marker([p.lat,p.lon]).addTo(map).bindPopup(p.name||"Konum"));

      if(points.length) map.fitBounds(points.map(p=>[p.lat,p.lon]),{padding:[20,20]});
      if(poly){map.removeLayer(poly);}
      if(points.length===2){
        poly=L.polyline([[points[0].lat,points[0].lon],[points[1].lat,points[1].lon]],{
          color:'#22d3ee',
          weight:3,
          dashArray:'6 6'
        }).addTo(map);
      }
    }

    async function loadCity(name){
      if(!name){
        cards.innerHTML="<div class='card reveal-init reveal-visible'>L√ºtfen ≈üehir yazƒ±n.</div>";
        return;
      }
      try{
        status.textContent="Y√ºkleniyor...";
        status.style.borderColor = "rgba(56,189,248,0.95)";

        const geoRes=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(name)}&count=1&language=tr`);
        const geo=await geoRes.json();
        const item=geo?.results?.[0];
        if(!item){
          cards.innerHTML="<div class='card reveal-init reveal-visible'>≈ûehir bulunamadƒ±.</div>";
          status.textContent="Hazƒ±r";
          status.style.borderColor = "rgba(56,189,248,0.8)";
          return;
        }

        const {latitude,longitude,name:city,country,country_code}=item;
        const destName=destInput.value.trim();
        let dest=null;

        if(destName){
          const dRes=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(destName)}&count=1&language=tr`);
          const dj=await dRes.json();
          dest=dj?.results?.[0] ? {
            lat:dj.results[0].latitude,
            lon:dj.results[0].longitude,
            name:dj.results[0].name,
            country:dj.results[0].country
          } : null;
        }

        const weatherRes=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current=temperature_2m,weathercode,wind_speed_10m&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max&timezone=auto`);
        const weather=await weatherRes.json();

        let countryInfo=null;
        if(country_code){
          try{
            const cRes=await fetch(`https://restcountries.com/v3.1/alpha/${country_code}`);
            const cj=await cRes.json();
            countryInfo=cj?.[0]||null;
          }catch(err){}
        }

        const currentCode=weather?.current?.weathercode;
        const currentIcon=weatherIcons[currentCode]||"üåç";
        const todayMax=weather?.daily?.temperature_2m_max?.[0];
        const todayMin=weather?.daily?.temperature_2m_min?.[0];
        const rainProb=weather?.daily?.precipitation_probability_max?.[0];

        const pop=countryInfo?.population ? (countryInfo.population/1_000_000).toFixed(1)+"m" : "Bilinmiyor";
        const currency=countryInfo?.currencies ? Object.keys(countryInfo.currencies)[0] : "-";
        const tz=countryInfo?.timezones?.[0] || "Yerel";

        const budgetBase=60 + (countryInfo?.population? Math.min(countryInfo.population/5_000_000,8)*10:20);
        const budgetCards=[
          {label:"B√ºt√ße",val:Math.round(budgetBase*0.7)},
          {label:"Konfor",val:Math.round(budgetBase)},
          {label:"L√ºks",val:Math.round(budgetBase*1.4)}
        ];
        const inspo=poiDb[city] || ["Eski ≈üehir turu","Yerel sokak lezzetleri","G√ºn batƒ±mƒ± manzarasƒ±","M√ºze/galeri ziyareti","Parkta y√ºr√ºy√º≈ü"];

        cards.innerHTML=`
          <div class="card floaty reveal-init">
            <div class="badge">${city}, ${country}</div>
            <h2 style="margin:8px 0 6px;font-size:22px;">${currentIcon} ${fmt(weather?.current?.temperature_2m)}¬∞C</h2>
            <p class="muted">R√ºzgar: ${fmt(weather?.current?.wind_speed_10m)} km/s ¬∑ Yaƒüƒ±≈ü ihtimali: ${rainProb ?? "-"}%</p>
            <div class="flex" style="margin-top:10px;">
              <div class="stat">
                <div class="muted">Bug√ºn</div>
                <strong>${fmt(todayMin)} / ${fmt(todayMax)}¬∞C</strong>
              </div>
              <div class="stat">
                <div class="muted">Saat dilimi</div>
                <strong>${tz}</strong>
              </div>
              <div class="stat">
                <div class="muted">N√ºfus</div>
                <strong>${pop}</strong>
              </div>
              <div class="stat">
                <div class="muted">Para birimi</div>
                <strong>${currency}</strong>
              </div>
            </div>
          </div>
          <div class="card reveal-init">
            <div class="badge">B√ºt√ße Tahmini (g√ºnl√ºk)</div>
            <div class="flex" style="margin-top:10px;">
              ${budgetCards.map(b=>`
                <div class="stat">
                  <div class="muted">${b.label}</div>
                  <strong>$${b.val}</strong>
                </div>`).join("")}
            </div>
            <p class="muted" style="margin-top:8px;font-size:12px;">
              Tahminler ≈üehir pop√ºlasyonu ve b√∂lgeye g√∂re kaba hesaplamadƒ±r.
            </p>
          </div>
          <div class="card reveal-init">
            <div class="badge">ƒ∞lham</div>
            <div class="chips" style="margin-top:10px;">
              ${inspo.map(i=>`<span class="chip">${i}</span>`).join("")}
            </div>
          </div>
        `;

        // Yeni kartlara da reveal efekti
        document.querySelectorAll('.card.reveal-init').forEach(el=>{
          el.classList.add('reveal-visible');
        });

        const points=[{lat:latitude,lon:longitude,name:city}];
        if(dest) points.push({lat:dest.lat,lon:dest.lon,name:dest.name});
        setMarkers(points);

        if(dest){
          const km=haversine(points[0],points[1]);
          const modes=[
            {m:"Araba",v:80},
            {m:"Tren",v:120},
            {m:"U√ßu≈ü",v:700},
            {m:"Y√ºr√ºy√º≈ü",v:5}
          ];
          routeInfo.textContent=`Mesafe ${km.toFixed(1)} km ¬∑ ${modes.map(m=>`${m.m}: ${(km/m.v*60).toFixed(0)} dk`).join(" ¬∑ ")}`;
        }else{
          routeInfo.textContent="Varƒ±≈ü yazarsanƒ±z mesafe ve s√ºreleri g√∂r√ºrs√ºn√ºz.";
        }

        planList.innerHTML = dest
          ? `<li>${city} - ${dest.name} arasƒ± rota √ßizildi. ≈ûehir i√ßi planƒ± kendin se√ßebilirsin.</li>`
          : "<li>Varƒ±≈ü yazarsan rota √ßizilir.</li>";

        status.textContent="Hazƒ±r";
        status.style.borderColor = "rgba(56,189,248,0.8)";
      }catch(err){
        console.error(err);
        status.textContent="Hata";
        status.style.borderColor = "rgba(239,68,68,0.9)";
        cards.innerHTML="<div class='card reveal-init reveal-visible'>Veri alƒ±namadƒ±.</div>";
      }
    }

    // ƒ∞lk a√ßƒ±lƒ±≈üta ƒ∞stanbul
    loadCity("Istanbul");
  })();
  </script>
</body>
</html>
